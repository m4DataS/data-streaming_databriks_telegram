---
bundle:
  name: "telegram_qa"
 
include:
  - variables.yml
  - 0-telegram_pull_finite.yml
  - 2-stream_autoloader.yml
  - 3-llm_response.yml
 
sync:
  paths:
    - 0-telegram_pull_finite.py
    - 1-telegram_pull_finite_webhook.py
    - 2-stream_autoloader.py
    - 3-llm_response.py



experimental:
  scripts:
    # Use quotes around the path to prevent shell parsing errors
    predeploy: |
      # 1. Create the directories in the volume if they do not exist
      databricks fs mkdirs "dbfs:/Volumes/${var.catalog_name}/${var.schema_name}/${var.volume_name}/checkpoint"
      databricks fs mkdirs "dbfs:/Volumes/${var.catalog_name}/${var.schema_name}/${var.volume_name}/data"

      # 2. Run the initialization job (which contains your CREATE TABLE logic)
      cd infra/ && databricks bundle run "${var.create_table_bronze_job_name}" --profile dev

targets:
  dev:
    mode: development
    default: true
    workspace:
      # host:
      root_path: /Workspace/Users/${workspace.current_user.userName}/.bundle/${bundle.name}/${bundle.target}
    permissions:
      - user_name: ${workspace.current_user.userName}
        level: CAN_MANAGE
